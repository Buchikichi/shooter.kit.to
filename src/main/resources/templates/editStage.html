<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title th:text="${stage.map.name}"></title>
<link rel="icon" type="image/x-icon" href="/img/icon.shooter.ico"/>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"/>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<script type="text/javascript" src="/js/implementor-min.js"></script>
<script type="text/javascript" src="/js/editStage-min.js"></script>
<style type="text/css">
* {
	margin: 0;
	padding: 0;
}
/*
body {
	overflow: hidden;
}
*/
#view {
	position: relative;
	overflow: auto;
	z-index: 0;
	transform-origin: top left;
	color: white;
	background-color: black;
	/*border: 1px blue dotted;*/
	-moz-user-select: none;
	-webkit-user-select: none;
	-ms-user-select: none;
}
#canvas {
	position: absolute;
	z-index: 1000;
}
#transition {
	position: absolute;
	z-index: 1001;
}
/* #actorPanel img {
	min-width: 1em;
	max-width: 2em;
	min-height: 1em;
	max-height: 2em;
} */
</style>
</head>

<body>
  <div data-role="page">
    <div id="view">
      <div id="frame">
        <canvas id="canvas"></canvas>
        <canvas id="transition"></canvas>
      </div>
      <div id="loading"></div>
    </div>
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
      <div id="panel">
        <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
          <a href="#attrPanel" class="ui-btn ui-corner-all ui-btn-icon-left ui-icon-bullets">Attributes</a>
          <button disabled="disabled" data-theme="b">Event</button>
          <label>Select<input type="radio" name="behavior" value="e"/></label>
          <label>Edit<input type="radio" name="behavior" value="s" checked="checked"/></label>
          <label>Remove<input type="radio" name="behavior" value="r"/></label>
          <button disabled="disabled" data-theme="b">Grid</button>
          <select name="grid">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="4" selected="selected">4</option>
            <option value="8">8</option>
          </select>
          <button disabled="disabled" data-theme="b">Guide</button>
          <label>ON<input type="radio" name="guide" value="1" checked="checked"/></label>
          <label>off<input type="radio" name="guide" value="0"/></label>
          <button disabled="disabled" data-theme="b">Brick</button>
          <label>B<input type="radio" name="color" value="b"/></label>
          <label>W<input type="radio" name="color" value="w"/></label>
          <label>-<input type="radio" name="color" value="-" checked="checked"/></label>
          <button disabled="disabled" data-theme="b">Scale</button>
          <select name="scale">
            <option value="1">1</option>
            <option value="2" selected="selected">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
          <!--
          <button id="migButton" type="button" data-theme="b">+8</button>
          -->
        </fieldset>
      </div>
      <button id="saveButton" type="button" class="ui-btn-right ui-btn ui-btn-b ui-btn-inline ui-mini ui-corner-all ui-btn-icon-left ui-icon-check" th:text="#{button.save}">Save</button>
    </div>
    <div id="attrPanel" data-role="panel" data-position="left" data-display="overlay" th:object="${stage}">
      <form id="attrForm" enctype="multipart/form-data"
           th:with="transitionList=${T(to.kit.shooter.entity.TransitionType).LIST}">
        <input type="hidden" th:name="${_csrf.headerName}" th:value="${_csrf.token}"/>
        <input id="productId" type="hidden" th:value="*{product.id}"/>
        <input id="mediasetId" type="hidden" th:value="*{product.mediaset.id}"/>
        <input id="stageId" type="hidden" th:value="*{id}"/>
        <input type="text" required="required" th:field="*{name}"/>
        <label><span>V-Scroll type:</span>
          <select name="roll" data-mini="true" th:field="*{roll}" th:with="scrollList=${T(to.kit.shooter.entity.ScrollType).DEFAULT_LIST}">
            <option th:each="opt:${scrollList}" th:value="${opt.value}" th:text="${opt}">OFF</option>
          </select>
        </label>
        <label><span>V-Start pos:</span>
          <input type="text" th:field="*{posH}" disabled="disabled"/>
        </label>
        <label><span>H-Repeat:</span>
          <input type="number" min="1" th:field="*{repeat}" />
        </label>
        <label><span>H-Start pos:</span>
          <input type="range" min="0" max="4" th:field="*{posV}"/>
        </label>
        <div data-role="collapsibleset">
          <div data-role="collapsible" data-mini="true">
            <h2>Start or retry</h2>
            <ul data-role="listview">
              <li data-role="list-divider">Transition:</li>
              <li class="ui-field-contain">
                <select data-mini="true" th:field="*{startTransition}">
                  <option th:each="opt:${transitionList}" th:value="${opt.value}" th:text="${opt}">OFF</option>
                </select>
                <input type="range" min="1" max="30" th:field="*{startSpeed}"/>
                <button type="button" data-rel="close" class="ui-btn ui-mini ui-corner-all">Preview</button>
              </li>
              <li data-role="list-divider">BGM:</li>
              <li class="ui-field-contain">
                <button type="button" name="startAudio" th:value="*{startAudioSeq}"
                    th:attr="data-type=${T(to.kit.shooter.entity.type.AudioType).Theme.ix}"
                    class="ui-btn ui-mini ui-corner-all ui-btn-icon-right ui-icon-carat-d audioSelector">&nbsp;</button>
              </li>
            </ul>
          </div>
          <div data-role="collapsible" data-mini="true">
            <h2>Sequel</h2>
            <ul data-role="listview">
              <li data-role="list-divider">Transition:</li>
              <li class="ui-field-contain">
                <select data-mini="true" th:field="*{sequelTransition}">
                  <option th:each="opt:${transitionList}" th:value="${opt.value}" th:text="${opt}">OFF</option>
                </select>
                <input type="range" min="1" max="30" th:field="*{sequelSpeed}">
                <button type="button" data-rel="close" class="ui-btn ui-mini ui-corner-all">Preview</button>
              </li>
              <li data-role="list-divider">BGM:</li>
              <li class="ui-field-contain">
                <button type="button" name="sequelAudio" th:value="*{sequelAudioSeq}"
                    th:attr="data-type=${T(to.kit.shooter.entity.type.AudioType).Theme.ix}"
                    class="ui-btn ui-mini ui-corner-all ui-btn-icon-right ui-icon-carat-d audioSelector">&nbsp;</button>
              </li>
            </ul>
          </div>
        </div>
<!--
        <fieldset data-role="controlgroup" data-mini="true">
          <legend>BG1:</legend>
          <input type="number" name="bg1speed" min="0" max="1" step="0.1"/>
          <input type="number" name="bg1dir"/>
          <input type="number" name="bg1blink"/>
        </fieldset>
        <button type="button" data-rel="close" class="ui-btn ui-mini ui-btn-b ui-corner-all">Close</button>
        <fieldset data-role="collapsible" data-mini="true">
          <legend>Trial</legend>
          <input id="mapFile" type="file"/>
        </fieldset>
-->
      </form>
    </div>
    <div id="eventPanel" data-role="panel" data-position="left" data-display="overlay">
      <div data-role="collapsibleset" data-mini="true" data-inset="false">
        <div data-role="collapsible" th:with="modeList=${T(to.kit.shooter.entity.ScenarioType).MODE_LIST}">
          <h3>Mode</h3>
          <fieldset data-role="controlgroup" data-mini="true">
            <label th:each="opt:${modeList}"><input type="radio" name="op" th:value="${opt}" data-type="mode"/>
              <span th:text="#{${opt.value}}"></span>
            </label>
          </fieldset>
        </div>
        <div data-role="collapsible">
          <h3>Effect</h3>
          <fieldset data-role="controlgroup" data-mini="true" data-inset="false"
              th:with="modeList=${T(to.kit.shooter.entity.ScenarioType).EFFECT_LIST}">
              <label th:each="opt:${modeList}"><input type="radio" name="op" th:value="${opt}" data-type="effect"/>
                <span th:text="#{${opt.value}}"></span>
              </label>
            </fieldset>
          </div>
        <div data-role="collapsible">
          <h3>Audio</h3>
          <fieldset data-role="controlgroup" data-mini="true" data-inset="false"
              th:with="audioList=${T(to.kit.shooter.entity.ScenarioType).AUDIO_LIST}">
            <label th:each="opt:${audioList}"><input type="radio" name="op" th:value="${opt}" data-type="audio">
              <span th:text="#{${opt.value}}"></span>
            </label>
          </fieldset>
          <fieldset id="audioSelectorButton" data-role="controlgroup" data-mini="true">
            <button class="ui-btn ui-corner-all ui-btn-icon-right ui-icon-carat-d audioSelector">&nbsp;</button>
          </fieldset>
        </div>
        <div data-role="collapsible" data-collapsed="false">
          <h3>Actor</h3>
          <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
            <button class="ui-btn ui-btn-b" disabled="disabled">Type</button>
            <select name="actorType" th:with="typeList=${T(to.kit.shooter.entity.type.VisualType).List}">
              <option th:each="opt:${typeList}" th:value="${opt.ix}" th:text="${opt}">opt</option>
            </select>
          </fieldset>
          <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
            <label>Reverse<input type="radio" name="actor_op" value="Rev"/></label>
            <label>Forward<input type="radio" name="actor_op" value="Spw" checked="checked"/></label>
          </fieldset>
          <div>
            <ul id="actorList" data-role="listview" data-filter="true" data-inset="true">
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div id="editEventPanel" data-role="panel" data-position="left" data-display="overlay">
      <input type="text" name="op" readonly/>
      <label><span>Belongings:</span>
        <button type="button" name="belongings"
          th:attr="data-type=${T(to.kit.shooter.entity.type.VisualType).Item.ix}"
          class="ui-btn ui-mini ui-corner-all ui-btn-icon-right ui-icon-carat-d actorSelector">&nbsp;</button>
      </label>
    </div>
    <div id="messagePopup" data-role="popup" data-overlay-theme="b" class="ui-content" style="max-width:280px">
      <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-left">Close</a>
      <p></p>
    </div>
    <div th:replace="_actorSelector"></div>
    <div th:replace="_audioSelector"></div>
  </div>
</body>
</html>
