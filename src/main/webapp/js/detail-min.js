var $jscomp={scope:{},inherits:function(a,b){function e(){}e.prototype=b.prototype;a.prototype=new e;a.prototype.constructor=a;for(var c in b)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c]}},EntityBase=function(){};EntityBase.prototype.list=function(a){a=void 0===a?{}:a;return $.ajax({type:"post",url:"/"+this.base+"/list",dataType:"json",data:a})};
EntityBase.prototype.select=function(a){var b=new FormData;b.append("id",a);return fetch("/"+this.base+"/select",{method:"post",body:b}).then(function(a){return a.json()})};EntityBase.prototype.save=function(a){a=new FormData(a);return $.ajax({type:"post",url:"/"+this.base+"/save",dataType:"json",data:a,processData:!1,contentType:!1})};var ActorEntity=function(){EntityBase.call(this);this.base="actor"};$jscomp.inherits(ActorEntity,EntityBase);
var AudioEntity=function(){EntityBase.call(this);this.base="audio"};$jscomp.inherits(AudioEntity,EntityBase);var Customer=function(){};Customer.prototype.check=function(){return $.ajax({type:"post",url:"/customer/check",dataType:"json",data:{}})};Customer.prototype.signIn=function(a,b){return $.ajax({type:"post",url:"/customer/signIn",dataType:"json",data:{userid:a,passwd:b}})};var ImageEntity=function(){EntityBase.call(this);this.base="image"};$jscomp.inherits(ImageEntity,EntityBase);
var Product=function(){EntityBase.call(this);this.base="product"};$jscomp.inherits(Product,EntityBase);var StageEntity=function(){EntityBase.call(this);this.base="stage"};$jscomp.inherits(StageEntity,EntityBase);var TitleBg=function(){this.x=0;this.width=1200;this.move()};TitleBg.prototype.move=function(a){var b=this;document.querySelector("div[data-role=header]").style.backgroundPosition=-this.x+"px 0";this.x++;this.width<this.x&&(this.x=0);requestAnimationFrame(function(a){return b.move(a)})};
document.addEventListener("DOMContentLoaded",function(){new AppMain;new TitleBg});var AppMain=function(){this.productStageView=document.getElementById("productStageView");this.stagePanel=document.getElementById("stagePanel");this.stageView=document.getElementById("stageView");this.product=new Product;this.customer=new Customer;this.stage=new StageEntity;this.setupButton();this.setupPanel();this.checkCustomer();$(this.productStageView).sortable()};
AppMain.prototype.setupButton=function(){var a=this;document.getElementById("saveButton").addEventListener("click",function(){a.saveProduct()})};
AppMain.prototype.setupPanel=function(){var a=this;document.querySelector('[data-role="header"] a').addEventListener("click",function(){a.stage.list("").then(function(b){$(a.stageView).empty();b.forEach(function(b){var c=a.createRow(b),d=c.querySelector("a");a.stageView.append(c);d.addEventListener("click",function(){a.addStage(b);$(a.stagePanel).panel("close")})});$(a.stageView).listview("refresh")})})};
AppMain.prototype.addStage=function(a){var b=!1;this.productStageView.querySelectorAll("li").forEach(function(c){c.getAttribute("data-id")==a.id&&(b=!0)});if(!b){var e=this.createRow(a);e.setAttribute("data-icon","false");this.productStageView.append(e);$(this.productStageView).listview("refresh")}};
AppMain.prototype.createRow=function(a){var b=document.createElement("img"),e=document.createElement("span"),c=document.createElement("p"),d=document.createElement("a"),f=document.createElement("li");b.setAttribute("src","/img/icon.listview.png");e.innerText=a.name;c.innerText=a.description;d.append(b);d.append(e);d.append(c);f.setAttribute("data-id",a.id);f.append(d);return f};
AppMain.prototype.checkCustomer=function(){this.customer.check().then(function(a){a.ok&&($("#footerNav a:eq(1)").removeClass("ui-state-disabled"),$("#footerNav a:eq(2)").removeClass("ui-state-disabled"),$("#footerNav").navbar("refresh"))})};AppMain.prototype.saveProduct=function(){var a=document.getElementById("productForm");this.product.save(a).then(function(a){console.log(a)})};
